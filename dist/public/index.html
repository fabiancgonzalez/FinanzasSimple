<!DOCTYPE html> <html lang="es"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Gestor de Finanzas Personales</title> <link rel="stylesheet" href="styles.css"> <script> // Verificar autenticaciÃ³n ANTES de renderizar (function() { const token = localStorage.getItem('token'); const user = localStorage.getItem('user'); // Si no hay token O usuario, redirigir a login if (!token || !user) { // Detectar correctamente la base URL let baseUrl = '/finanzas'; const pathname = window.location.pathname; // Si el pathname contiene /finanzas, usar eso if (pathname.includes('/finanzas')) { baseUrl = pathname.substring(0, pathname.indexOf('/finanzas') + '/finanzas'.length); } console.log('[AUTH CHECK] No authentication found. Redirecting to login...'); console.log('[AUTH CHECK] pathname:', pathname); console.log('[AUTH CHECK] baseUrl:', baseUrl); window.location.replace(baseUrl + '/login'); // Detener la ejecuciÃ³n document.documentElement.style.display = 'none'; } })(); </script> </head> <body> <div class="container"> <header> <div class="header-content"> <h1>ğŸ’° Gestor de Finanzas Personales</h1> <div class="user-section"> <span id="userDisplay"></span> <button id="btnChangePassword" class="btn btn-info">ğŸ” Cambiar ContraseÃ±a</button> <button id="btnLogout" class="btn btn-logout">ğŸšª Salir</button> </div> </div> </header> <div class="exportar-section"> <button id="btnExportar" class="btn btn-exportar">ğŸ“Š Exportar a Excel</button> <button id="btnGuardarDatos" class="btn btn-guardar">ğŸ’¾ Guardar Datos</button> <button id="btnCargarServidor" class="btn btn-cargar">â˜ï¸ Cargar del Servidor</button> </div> <div class="card datos-mes-card" id="datosMesCard" style="display: none;"> <h2>ğŸ“… Datos del Mes Actual</h2> <div class="tabla-container"> <table id="tablaDatosMes"> <thead> <tr> <th>Tipo</th> <th>DescripciÃ³n</th> <th>Monto</th> <th>Fecha</th> </tr> </thead> <tbody id="bodyDatosMes"> <tr> <td colspan="4" class="empty">No hay datos para este mes</td> </tr> </tbody> </table> </div> <div class="resumen-mes"> <span>Total Ingresos: <strong id="ingresosMes">$0.00</strong></span> <span>Total Egresos: <strong id="egresosMes">$0.00</strong></span> <span>Balance: <strong id="balanceMes">$0.00</strong></span> </div> </div> <div class="resumen"> <div class="card resumen-card ingresos-card"> <h3>ğŸ’µ Total Ingresos</h3> <p class="monto" id="totalIngresos">$0.00</p> </div> <div class="card resumen-card egresos-card"> <h3>ğŸ’¸ Total Egresos</h3> <p class="monto" id="totalEgresos">$0.00</p> </div> <div class="card resumen-card balance-card"> <h3>ğŸ’ Balance</h3> <p class="monto" id="balance">$0.00</p> </div> </div> <div class="formularios"> <div class="card"> <h2>â• Agregar Ingreso</h2> <form id="formIngreso"> <input type="text" id="descripcionIngreso" placeholder="DescripciÃ³n (ej: Salario)" required> <input type="number" id="montoIngreso" placeholder="Monto" step="0.01" min="0.01" required> <button type="submit" class="btn btn-ingreso">Agregar Ingreso</button> </form> </div> <div class="card"> <h2>â– Agregar Egreso</h2> <form id="formEgreso"> <input type="text" id="descripcionEgreso" placeholder="DescripciÃ³n (ej: Alquiler)" required> <input type="number" id="montoEgreso" placeholder="Monto" step="0.01" min="0.01" required> <button type="submit" class="btn btn-egreso">Agregar Egreso</button> </form> </div> </div> <div class="tablas"> <div class="card"> <h2>ğŸ“ˆ Ingresos</h2> <div class="tabla-container"> <table id="tablaIngresos"> <thead> <tr> <th>DescripciÃ³n</th> <th>Monto</th> <th>Fecha</th> <th>AcciÃ³n</th> </tr> </thead> <tbody id="bodyIngresos"> <tr> <td colspan="4" class="empty">No hay ingresos registrados</td> </tr> </tbody> </table> </div> </div> <div class="card"> <h2>ğŸ“‰ Egresos</h2> <div class="tabla-container"> <table id="tablaEgresos"> <thead> <tr> <th>DescripciÃ³n</th> <th>Monto</th> <th>Fecha</th> <th>AcciÃ³n</th> </tr> </thead> <tbody id="bodyEgresos"> <tr> <td colspan="4" class="empty">No hay egresos registrados</td> </tr> </tbody> </table> </div> </div> </div> </div> <div id="changePasswordModal" class="modal"> <div class="modal-content"> <span class="close">&times;</span> <h2>ğŸ” Cambiar ContraseÃ±a</h2> <form id="changePasswordForm"> <div class="form-group"> <label for="currentPassword">ContraseÃ±a Actual</label> <input type="password" id="currentPassword" placeholder="Tu contraseÃ±a actual" required> </div> <div class="form-group"> <label for="newPassword">Nueva ContraseÃ±a</label> <input type="password" id="newPassword" placeholder="Nueva contraseÃ±a (mÃ­n. 8 caracteres)" required> <small>Debe contener mayÃºscula, minÃºscula y nÃºmero</small> </div> <div class="form-group"> <label for="confirmPassword">Confirmar ContraseÃ±a</label> <input type="password" id="confirmPassword" placeholder="Confirma tu nueva contraseÃ±a" required> </div> <button type="submit" class="btn btn-primary">Cambiar ContraseÃ±a</button> <div id="changePasswordMessage" class="message"></div> </form> </div> </div> <script src="app.js"></script> </body> </html>